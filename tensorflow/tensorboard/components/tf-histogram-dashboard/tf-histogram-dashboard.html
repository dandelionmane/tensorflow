<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../tf-dashboard-common/dashboard-style.html">
<link rel="import" href="../tf-dashboard-common/warning-style.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../tf-imports/lodash.html">
<link rel="import" href="tf-vz-histogram-series.html">
<link rel="import" href="tf-actions-panel.html">
<link rel="import" href="tf-runs-panel.html">
<script src="../../lib/js/requestManager/requestManager.js"></script>
<script src="../../lib/js/backend/urlPathHelpers.js"></script>
<script src="../../lib/js/backend/backend.js"></script>
<script src="../../lib/js/nanite/nanite.js"></script>
<script src="../../lib/js/node-radar/nodeRadar.js"></script>
<script src="main.js"></script>


<!--
tf-compressed-histogram-dashboard is a complete frontend that loads runs from a backend,
and creates chart panes that display data for those runs.

It provides a categorizer, run selector, and x type selector, by which the user
can customize how data is organized and displayed.

Each chart has a button that can toggle whether it is "selected"; selectedRuns
charts are larger.

Organizationally, the #plumbing div contains components that have no concrete
manifestation and just effect data bindings or data loading. The #sidebar contains
shared controls like the tf-categorizer, tf-run-selector, and tf-x-type-selector.
The #center div contains tf-charts embedded inside tf-collapsable-panes.
-->
<dom-module id="tf-histogram-dashboard">
  <template>
    <style>
      :host {
        display: flex;
        position: relative;
        height: 100%;
      }
      #runs {
        width: 300px;
        height: 100%;
        position: fixed;
      }
      #main {
        height: 100%;
        margin-left: 300px;
        flex: 1;
        position: relative;
        background: white;
      }
      #main #actions {
        position: fixed;
        width: calc(100% - 300px);
      }
      #main #scroll-content {
        position: absolute;
        top: 64px;
        width: 100%;
        height: 700px;
        padding: 0;
      }
      #main #content {
        /*position: relative;*/
      }
      #main #frame {
        position: fixed;
        box-sizing: border-box;
        z-index: -10000;
        border: solid 1px magenta;
        top: calc(64px + 70px);
        width: calc(100% - 300px);
        height: calc(100% - 64px - 70px);
        pointer-events: none;
        visibility: hidden;
      }
      .category {
        box-sizing: border-box;
        position: absolute;
        overflow: hidden;
        background: white;
        width: 100%;
        border-bottom: solid 1px #eee;
      }
      .category h3 {
        font-weight: 700;
        font-size: 14px;
        text-transform: uppercase;
        padding: 0 24px;
        margin: 0;
        height: 60px;
        line-height: 60px;
        border-bottom: solid 1px #eee;
        position: absolute;
        top: 0;
        width: 100%;
      }
      .tag {
        box-sizing: border-box;
        position: absolute;
        width: 100%;
        overflow: hidden;
      }
      .tag h4 {
        position: absolute;
        top: 0;
        left: 0;
        font-size: 16px;
        font-weight: 500;
      }
      .run {
        position: absolute;
        top: 0;
        left: 0;
        overflow: hidden;
        color: black;
      }
      .run h5 {
        font-size: 13px;
        color: var(--paper-grey-600);
        font-weight: 400;
        position: absolute;
        top: 0;
        left: 24px;
        margin: 0;
      }
      .run tf-vz-histogram-series {
        position: absolute;
        left: 0;
        top: 15px;
      }
    </style>


    <tf-runs-panel
      id="runs"
    ></tf-runs-panel>
      <!-- runs="[[_runs]]"
      class-scale="[[classScale]]"
      out-selected="{{selectedRuns}}"
      tooltips="[[tooltipMap]]"
      closest-run="[[closestRun]]"
      x-value="[[tooltipXValue]]"
      x-type="[[xType]]" -->
    <div id="main">
      <div id="frame"></div>
      <div id="scroll-content">
        <div id="content"></div>
      </div>
      <tf-actions-panel
      id="actions"
      ></tf-actions-panel>
    </div>

    <style include="dashboard-style"></style>
    <style include="warning-style"></style>
  </template>

  <script>
    Polymer({
      is: "tf-histogram-dashboard",
      properties: {},
      ready: function() {
        TF.makeHistogramDashboard(this.$.content, this);
      }
    });
  </script>
</dom-module>
